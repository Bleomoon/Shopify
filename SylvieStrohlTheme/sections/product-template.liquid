
<div class="productTemplate">
  {%comment%} Fiche Produit {%endcomment%}
  <div class="ficheProduct">
      {% assign current_variant = product.selected_or_first_available_variant %}
      {% assign featured_image = current_variant.featured_image | default: product.featured_image %}
    
      {%comment%} Zone sur les images {%endcomment%}
      <div class="ficheProduct-SousImg">
        {% for image in product.images %}
          {% capture _ %}{% increment id %}{% endcapture %}
          <img class="SousImg-Img" id="ficheProduct-SousImg-{{ id }}" onclick=changeImageProduct('{{ image.src | img_url: '700x700' }}'); src="{{ image.src | img_url: 'small' }}" alt="{{ image.alt | escape }}">
        {% endfor %}
      </div>
    
      <div class="ficheProduit-BigImg">
        <img id="ficheProduit-BigImg" class="BigImg-Image" src="{{ featured_image.src | img_url: '700x700' }}" alt="{{ product.title }}">
        <button class="BigImg-Zoom"><i class="fas fa-search-plus"></i></button>
      </div>

      {%comment%} Zone sur le contenu de la fiche produit {%endcomment%}
      <div class="ficheProduct-Contenu">
        <div class="ficheProduct-Haut">
          {%comment%} Zone sur le titre et le prix {%endcomment%}
          <h1 class="ficheProduct-Contenu-Title">{{ product.title }}</h1>
          <h2 class="ficheProduct-Contenu-Prix">{{ product.price | money }}</h2>

          {%comment%} Zone des bouttons pour changer d'articles {%endcomment%}
          <div class="ficheProduct-OtherArticle">
            {% assign nextHref = '' %} {% assign backHref = '' %}
            {% for collection in product.collections %}
              {% if collection.next_product.available and nextHref != '' and collection.next_product.id != product.id %}
                {% assign nextHref = collection.next_product.url %}
              {% endif %}
              {% if collection.previous_product.available and backHref != ''  and collection.previous_product.id != product.id %}
                {% assign backHref = collection.previous_product.url %}
              {% endif %}
            {% endfor %}
            {% if nextHref != '' %}
              <a class="aRef" href={{ collection.next_product.url }}>
                <button class="buttonRef">
                  <i class="fas fa-chevron-right"></i>
                </button>
              </a>
            {% endif %}

            {% if backHref != '' %}
              <a class="aRef" href={{ collection.previous_product.url }}>
                <button class="buttonRef">
                  <i class="fas fa-chevron-left"></i>
                </button>
              </a>
            {% endif %}
          </div>
        </div>
        
        {%comment%} Zone sur la description du produit {%endcomment%}
        <div class="ficheProduct-Desc">{{ product.description }}</div>
    
        {%comment%} Zone sur le contenu personnalisé : prix/quantity etc {%endcomment%}
        {% form "product", product %}
          <form action="/cart/add" method="post" enctype="multipart/form-data">
            <select name="id">
              {% for variant in product.variants %}
              {% if variant.available == true %}
              <option value="{{variant.id}}"> {{ variant.title }} for
                {{ variant.price | money_with_currency }}</option>
              {% else %}
              <option disabled="disabled"> {{ variant.title }} - sold out!</option>
              {% endif %}
              {% endfor %}
            </select>
            <button type="submit" name="add" id="add" class="ajouterPanier">
              <i class="fas fa-cart-plus"></i> Ajouter au panier
            </button>
          </form>
        {% endform %}

        {%comment%} Zone des logos, l'admin les rajotue, jusqu'a 8 {%endcomment%}
        <div class="ficheProduct-Logos">
          {% for block in section.blocks %}
            {% if block.type == 'logo' %}
              <div class="logoDiv">
                <a class="aRef" href="{{ block.settings.logoUrl }}">
                  <img alt="{{ block.settings.logoUrl }}" src={{ block.settings.logoImage | img_url: '50x50' }}>
                </a>
            </div>
            {% endif %}
          {% endfor %}
        </div>
    
      </div>
  </div>

  {% comment %} Les informations sur le produit : sa description et ces informations complémentaires qui sont : 
  - Variants, Poids, balises, type, Modèle  {% endcomment %}
  <div class="infosComplementairesProduct">
    <div class="menu-infosComplementairesProduct">
      <div id="menuButton-Description" class="menuButton-Description" onclick="switchMenu(1)">
        Description
        {% if section.settings.showButton == true %}
          <a class="aRef" href="{{ section.settings.urlButton }}"><button class="buttonRef">{{ section.settings.textButton }}</button></a>
        {% endif %}
      </div>
      <div id="menuButton-Informations" class="menuButton-Informations" onclick="switchMenu(2)">
        Informations complementaires
      </div>
    </div>
    <div id="info-Description" class="info-Description">
      {% for block in section.blocks %}
        <div class="info-Contenu">
        {% if block.type == "description" %}
          {{ block.settings.paragraphe }}
        {% endif %}
        </div>
      {% endfor %}
      
    </div>
    <div id="info-Informations" class="info-Informations">
      <div class="info-Contenu">
        
        {% comment %} l'affichage des variants {% endcomment %}
        {% for product_option in product.options_with_values %}          
            {% assign myvalues = '' %}
            {% for value in product_option.values %}
              {% if myvalues == '' %}
                {% assign myvalues = value %}
              {% else %}
                {% assign myvalues = myvalues | append: ', ' | append: value %}
              {% endif %}
            {% endfor %}
            <div class="une-Info-Contenu">
              <p>{{ product_option.name }}</p>
              <p>{{ myvalues }}</p>
            </div>
        {% endfor %}

        {% comment %} l'affichage des tags {% endcomment %}
        {% assign mytags = '' %}
        {% for tag in product.tags %}
          {% if mytags == '' %}
            {% assign mytags = tag %}
          {% else %}
            {% assign mytags = mytags | append: ', ' | append: tag %}
          {% endif %}
        {% endfor %}
        <div class="une-Info-Contenu">
          <p>Balises :</p> 
          <p>{{ mytags }}</p>
        </div>

        {% comment %} l'affichage du type {% endcomment %}
        <div class="une-Info-Contenu"> 
          <p>Type : </p>
          <p>{{ product.type }} </p>
        </div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "produit",
  "settings":[
    {
      "type":"checkbox",
      "id":"showButton",
      "label":"Afficher un boutton lien vers une autre page ?",
      "default": false
    },
    {
      "type":"url",
      "id":"urlButton",
      "label":"Lien du boutton"
    },
    {
      "type":"text",
      "id":"textButton",
      "label":"Texte du boutton"
    }
  ],
  "blocks":[
    {
      "type":"logo",
      "name":"logo",
      "limit":8,
      "settings":[
        {
          "type": "image_picker",
          "id": "logoImage",
          "label":"Image du logo"
        },
        {
          "type": "url",
          "id": "logoUrl",
          "label": "Lien de redirection"
        }  
      ]
    },
    {
      "type":"description",
      "name":"description",
      "limit":1,
      "settings":[
        {
          "type": "richtext",
          "id": "paragraphe",
          "label":"La description poussé du produit",
          "default":"<p>Ce produit ne dispose pas encore d'une description</p>"
        }
      ]
    }
  ]
}
{% endschema %}

{%comment%} Ici le style css {% endcomment %}
{% style %}
  .productTemplate{
    display: grid;
    width:80%;
    margin-right:10%;
    margin-left:10%;
    margin-top:25px;
    margin-bottom:25px;
  }
  /*CSS de la fiche d'un produit*/
  .ficheProduct {
    grid-column:1;
    grid-row:1;
    display:grid;
    grid-template-columns:repeat(3,1fr);
  }
  
  .ficheProduct-Img {
    display: grid;
    grid-column: 1;
    grid-row: 1;
  }
  
  .ficheProduit-BigImg {
    grid-column: 2;
    grid-row: 1;
    display:grid;
  }
  
  .BigImg-Image{
    z-index:1;
    grid-column:1;
    grid-row:1;
  }

  .BigImg-Zoom{
    z-index:2;
    background-color:white;
    grid-column:1;
    grid-row:1;
    width:max-content;
    margin:auto;
    margin-top:0;
    margin-left:0;
    padding:5px;
    border:none;
    color:black;
  }

  .BigImg-Zoom:hover{
    background-color:black;
    color:white;
  }

  .ficheProduct-SousImg {
    grid-column: 1;
    grid-row: 1;
    display: grid;
    background-size:contain;
    height:700px;
    overflow:auto;
    width:max-content;
  }

  .SousImg-Img{
    width:100%;
    margin-top:10px;
    margin-bottom:10px;
  }
  
  .SousImg-Img:hover{
    cursor:pointer;
  }

  .ficheProduct-Contenu {
    display: grid;
    grid-column: 3;
    grid-row: 1;
    margin:25px;
  }
  
  .ficheProduct-Haut{
    display:grid;
  }

  .ficheProduct-Contenu-Title {
    grid-column: 1;
    grid-row: 1;
    font-size:20px;
    font-family:cursive;
    width:max-content;
  }
  
  .ficheProduct-Contenu-Prix{
    grid-column: 1;
    grid-row: 2;
    font-size:15px;
    font-family:cursive;
    width:max-content;
  }

  .ficheProduct-OtherArticle{
    display:grid;
    grid-column: 2;
    grid-row: 1;
    width:max-content;
    margin:auto;
    margin-top:0;
  }

  .ajouterPanier{
    padding:15px;
    border:solid;
    border-color:black;
    background-color:white;
    color:black;
    margin-right:0;
  }

  .ajouterPanier:hover{
    border:none;
    background-color:black;
    color:white;
  }

  .ficheProduct-Logos {
    display:grid;
    grid-template-columns: repeat(8,1fr);
    grid-template-rows: repeat(1,1fr);
    border:solid;
    border-right:none;
    border-left:none;
    margin:auto;
  }

  .logoDiv{
    margin:5px;
  }

  .infosComplementairesProduct{
    display:grid;
    margin-top:25px;
    margin-bottom:25px;
    grid-column:1;
    grid-row:2;
  }

  .menu-infosComplementairesProduct{
    grid-column:1;
    grid-row:1;
    margin-bottom:auto;
    margin-right:15px;
    display:grid;
    grid-column:1/2;
    font-size:15px;
    font-family:cursive;
  }

  .menuButton-Description{
    margin-bottom:10px;
    color:gray;
  }

  .menuButton-Description:hover{
    cursor:pointer;
  }

  .menuButton-Informations{
    color:black;
  }

  .menuButton-Informations:hover{
    cursor:pointer;
  }

  .info-Description{
    display:grid;
    border-left:solid;
    grid-column:2;
    grid-row:1;
    grid-column:2/10;
  }

  .info-Informations{
    display:none;
    border-left:solid;
    grid-column:2;
    grid-row:1;
    grid-column:2/10;
  }
  
  .info-Contenu{
    margin-left:15px;
    display:grid;
  }

  .une-Info-Contenu{
    grid-template-columns:repeat(2,1fr);
    grid-template-rows:repeat(1,1fr);
    display:grid;
  }
{% endstyle %}

{% comment %} Ici le javascript {% endcomment %}
<script>
  function switchMenu(numero)
  {
    var menuDesc = document.getElementById("menuButton-Description");
    var menuInfo = document.getElementById("menuButton-Informations");
    var infoDesc = document.getElementById("info-Description");
    var infoInfo = document.getElementById("info-Informations");
    
    if (numero < 2)
    {
        menuDesc.style.color = "gray";
        menuInfo.style.color = "black";
        infoInfo.style.display= "none";
        infoDesc.style.display = "grid";
    }
    else
    {
        menuInfo.style.color = "gray";
        menuDesc.style.color = "black";
        infoInfo.style.display = "grid";
        infoDesc.style.display = "none";
    }
  }

  function changeImageProduct(src)
  {
    var bigImg = document.getElementById("ficheProduit-BigImg");
    console.log("ma source : " + src);
    bigImg.src = src;
  }

  function nextImage(src)
  {
    var bigImg = document.getElementById("ficheProduit-BigImg");
    console.log("ma source : " + src);
    bigImg.src = src;
  }
</script>